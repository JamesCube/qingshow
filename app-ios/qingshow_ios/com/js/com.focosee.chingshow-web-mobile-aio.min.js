/* com.focosee.chingshow-web-mobile-0.2.0 */if(requirejs&&requirejs.s&&requirejs.s.contexts&&requirejs.s.contexts._){window.__andrea_internal_requirejs_nextTick__=requirejs.s.contexts._.nextTick;requirejs.s.contexts._.nextTick=function(a){a()}}define("ui/UIComponent",[],function(){var a=function(c,b){if(c.get){this._dom=c.get(0);this._dom$=c}else{this._dom=c;this._dom$=$(c)}this._trigger$=$({})};a.prototype.destroy=function(){this.trigger("destroying");this._dom$.remove();this.trigger("destroy");this._trigger$.off()};a.prototype.dom$=function(){return this._dom$};a.prototype.dom=function(){return this._dom};a.prototype.hide=function(){this._dom$.hide()};a.prototype.show=function(){this._dom$.show()};a.prototype.on=function(){this._trigger$.on.apply(this._trigger$,arguments)};a.prototype.trigger=function(){this._trigger$.trigger.apply(this._trigger$,arguments)};a.prototype.getPreferredSize=function(){};return a});define("ui/layout/Rectangle",[],function(){var a=function(e,d,c,b){this._left=e;this._top=d;this._width=c;this._height=b};a.parseDOM=function(c){var b=c.offset();return new a(b.left,b.top,c.outerWidth(),c.outerHeight())};a.prototype.left=function(b){if(arguments.length>0){this._left=b}else{return this._left}};a.prototype.top=function(b){if(arguments.length>0){this._top=b}else{return this._top}};a.prototype.right=function(b){if(arguments.length>0){this.left(b-this.width())}else{return this.left()+this.width()}};a.prototype.bottom=function(b){if(arguments.length>0){this.top(b-this.height())}else{return this.top()+this.height()}};a.prototype.width=function(){return this._width};a.prototype.height=function(){return this._height};a.prototype.hCenter=function(){return this.left()+this.width()/2};a.prototype.vCenter=function(){return this.top()+this.height()/2};a.prototype.hContains=function(b){return this.left()<=b.left()&&this.right()>=b.right()};a.prototype.vContains=function(b){return this.top()<=b.top()&&this.bottom()>=b.bottom()};a.prototype.contains=function(b){return this.hContains(b)&&this.vContains(b)};a.toJSON=function(b){return{left:b.left(),top:b.top(),width:b.width(),height:b.height()}};return a});define("ui/UIContainer",["ui/UIComponent"],function(b){var a=function(d,c){a.superclass.constructor.apply(this,arguments);this._children=[]};andrea.oo.extend(a,b);a.prototype.destroy=function(){this._children.forEach(function(c){c.destroy()});a.superclass.destroy.apply(this,arguments)};a.prototype.append=function(c){c.dom$().appendTo(this.dom$());this._children.push(c)};a.prototype.delegate=function(c){this._children.forEach(function(d){d.on(c,this.trigger(c))}.bind(this))};return a});define("ui/scroll/IScrollContainer",["ui/UIContainer"],function(b){var a=function(d,c){a.superclass.constructor.apply(this,arguments);this._dom$.addClass("uiIScrollWrapper").css({position:"absolute",overflow:"hidden"});this._scroller$=$("<div/>").addClass("uiIScroller").css({position:"absolute"}).appendTo(this._dom$);this._iscroll=null;this._validateIScroll()};andrea.oo.extend(a,b);a.prototype._validateIScroll=function(c){if(this._iscroll){this._iscroll.destroy()}this._iscroll=new IScroll(this.dom(),{mouseWheel:true,click:true})};a.prototype.append=function(c){c.dom$().appendTo(this._scroller$);c.on("resize",function(){this._validateIScroll()}.bind(this));this._children.push(c)};return a});define("app/views/ViewBase",["ui/UIComponent","app/ViewContainer"],function(c,b){var a=function(d){a.superclass.constructor.apply(this,arguments);this._dom$.addClass("qsView")};andrea.oo.extend(a,c);return a});define("app/managers/TemplateManager",[],function(){var a={};var b={};a.load=function(d,c,e){if(arguments.length===2){e=c;c=false}if(b[d]){e(null,b[d].clone())}else{$.ajax({url:"./templates/"+d+(andrea.env.debug?("?"+Math.random()):"")}).done(function(j){j=j.replace('<link href="../libs/font-awesome-4.2.0/css/font-awesome.css" rel="stylesheet"/>',"");j=j.replace('<link href="../css/app.css" rel="stylesheet"/>',"");j=j.replace(new RegExp("./assets","g"),"./templates/assets");j=j.replace(new RegExp("../../deps-fake/pics","g"),"../deps-fake/pics");var h=j.indexOf('<div id="wrapper"');if(h!==-1){j=j.substring(0,h)+j.substring(j.indexOf(">",h)+1,j.lastIndexOf("</div>"))}var g=$(j);var k=g.eq(0);k.appendTo(document.head);var l=g.eq(g.length-1);$(".fake",l).remove();if(!c){$(".fakeText",l).removeClass("fakeText").text("");$(".fakeSrc",l).removeClass("fakeSrc").attr("src","");$(".fakeBackgroundImage",l).removeClass("fakeBackgroundImage").css("background-image","none");var f=$(".fakeVideo",l);if(f.length){f.removeAttr("poster");$("source",f).remove()}}b[d]=l;e(null,l.clone())})}};return a});define("app/components/Header",["ui/UIComponent","app/managers/TemplateManager"],function(b,a){var c=function(e,d){c.superclass.constructor.apply(this,arguments);a.load("header.html",function(f,g){this._dom$.append(g);$(".qsTitle",this._dom$).text(d);$(".qsBack",this._dom$).on(appRuntime.events.click,function(){appRuntime.view.back()}.bind(this))}.bind(this))};andrea.oo.extend(c,b);c.prototype.getPreferredSize=function(){return{height:96}};return c});define("app/services/DataService",[],function(){var a={};a.request=function(d,b,e){var c;if(andrea.env.debug){c={url:"../deps-fake/data"+d+".json"}}else{c={url:appConfig.server.url+d,type:"POST",dataType:"json",data:b}}$.ajax(c).done(function(f){console.log("api: "+d,b,f);e(null,f)}).fail(function(g,h,f){e(h)}).always(function(){})};return a});define("app/utils/DateUtils",[],function(){var b={};var a;b.parseAge=function(e){if(!a){a=new Date()}var g=new Date(e);var f=a.getFullYear()-g.getFullYear();var c=a.getMonth()-g.getMonth();var d=a.getDate()-g.getDate();if(c>0||(c===0&&d>=0)){return f}else{return f-1}};return b});define("app/components/ItemGallery",["ui/UIComponent","app/managers/TemplateManager","app/services/DataService","app/utils/DateUtils"],function(e,b,a,g){var c,d;var f=function(h){f.superclass.constructor.apply(this,arguments);require(["app/views/Item","app/views/People"],function(i,j){c=i;d=j});this._tpltLiPeople$=null;this._dom$.css("overflow","auto");async.parallel([function(i){b.load("item-gallery.html",function(j,k){k.css("minHeight",this._dom$.height()+"px");this._dom$.append(k);i(null)}.bind(this))}.bind(this),function(i){b.load("item-gallery-li.html",function(j,k){i(null,k)}.bind(this))}.bind(this),function(i){a.request("/peoples",null,i)}.bind(this)],function(j,i){this._tpltLiPeople$=i[1];this._render(i[2])}.bind(this))};andrea.oo.extend(f,e);f.prototype._render=function(h){var i=$(".qsLiItemContainer",this._dom$);h.forEach(function(l,k){var m=this._renderPeople(this._tpltLiPeople$.clone(),l);var j;i.each(function(o,n){if(!j||j.children().length>$(n).children().length){j=$(n)}});m.appendTo(j)}.bind(this));$("img",this._dom).on("load",function(){this.trigger("resize")}.bind(this))};f.prototype._renderPeople=function(i,h){$(".qsItemCover",i).attr("src",h.cover);$(".qsItemDescription",i).text(h.itemDescription);$(".qsPortrait",i).css("background-image",andrea.string.substitute('url("{0}")',h.portrait));$(".qsName",i).text(h.name);$(".qsAge",i).text(g.parseAge(h.birthtime)+"岁");$(".qsStatus",i).text(h.status);$(".qsNumLikes",i).text(h.numLikes);$(".qsItemCover, .qsItemDescription",i).on("click",function(){appRuntime.view.to(c)}.bind(this));$(".qsPeople",i).on("click",function(){appRuntime.view.to(d)}.bind(this));return i};return f});define("app/views/Category",["ui/scroll/IScrollContainer","app/views/ViewBase","app/components/Header","app/components/ItemGallery"],function(a,b,e,d){var c=function(h){c.superclass.constructor.apply(this,arguments);var i=new e($("<div/>").appendTo(this._dom$),"分类 xxx");var f=new a($("<div/>").css({width:"100%",height:this._dom$.height()-i.getPreferredSize().height}).appendTo(this._dom$));var g=new d($("<div/>"));f.append(g)};andrea.oo.extend(c,b);return c});define("app/components/CategoryMenu",["ui/UIComponent","app/managers/TemplateManager","app/views/Category"],function(c,b,d){var a=function(e){a.superclass.constructor.apply(this,arguments);async.parallel([function(f){b.load("category-menu.html",f)}],function(g,f){var h=f[0];this._dom$.append(h);$("li").on("click",function(){appRuntime.view.to(d);appRuntime.popup.remove(this)}.bind(this))}.bind(this))};andrea.oo.extend(a,c);a.prototype.getPreferredSize=function(){return{width:640,height:510}};return a});define("app/components/HomeHeader",["ui/UIComponent","app/managers/TemplateManager","app/components/CategoryMenu"],function(c,b,a){var d=function(e){d.superclass.constructor.apply(this,arguments);b.load("home-header.html",function(f,g){this._dom$.append(g);var h;$(".qsCategoryMenu",g).on(appRuntime.events.click,function(){if(h){return}h=appRuntime.popup.create(a,true);appRuntime.popup.dock(h,this._dom$,"lb","down",0);h.on("destroy",function(){h=null})}.bind(this))}.bind(this))};andrea.oo.extend(d,c);d.prototype.getPreferredSize=function(){return{height:96}};return d});define("app/views/Home",["ui/scroll/IScrollContainer","app/views/ViewBase","app/components/HomeHeader","app/components/ItemGallery"],function(a,b,c,e){var d=function(h){d.superclass.constructor.apply(this,arguments);var i=new c($("<div/>").appendTo(this._dom$));var f=new a($("<div/>").css({width:"100%",height:this._dom$.height()-i.getPreferredSize().height}).appendTo(this._dom$));var g=new e($("<div/>"));f.append(g)};andrea.oo.extend(d,b);return d});define("app/ViewContainer",["ui/UIComponent","app/views/Home"],function(b,c){var a=function(d){a.superclass.constructor.apply(this,arguments);this._dom$.addClass("qsViewContainer");this._views=[];this._currentView=null;appRuntime.view.to=$.proxy(this.to,this),appRuntime.view.back=$.proxy(this.back,this);appRuntime.view.to(c)};andrea.oo.extend(a,b);a.prototype.to=function(e){var d=new e($("<div/>").appendTo(this._dom$));this._views.push(d);if(this._currentView){this._swapView(PageTransitions.animations.mobileNextPage,this._currentView,d,function(){this._currentView.hide();this._currentView=d}.bind(this))}else{this._currentView=d}};a.prototype.back=function(e){if(this._views.length<2){return}var d=this._views[this._views.length-2];this._views.pop();this._swapView(PageTransitions.animations.mobilePrevPage,this._currentView,d,function(){this._currentView.destroy();this._currentView=d}.bind(this))};a.prototype._swapView=function(f,e,d,g){e.show(),d.show();new PageTransitions(e.dom$(),d.dom$()).nextPage(f,g)};return a});define("ui/layout/DockToRectangle",[],function(){var a={};a.dock=function(c,b,f,d,e){c.dom$().css("position","absolute");if(d==="down"||d==="up"){c.dom$().css("left",f.substr(0,1)==="l"?b.left():b.right());c.dom$().css("top",d==="down"?b.bottom()+e:b.top()-e)}};return a});define("app/Root",["ui/UIComponent","ui/layout/Rectangle","app/ViewContainer","ui/layout/DockToRectangle"],function(c,b,a,d){var e=function(h,g,f){e.superclass.constructor.apply(this,arguments);this._dom$.addClass("qsRoot");this._scale=g/640;this._dom$.css({width:"640px",height:f/this._scale+"px","-webkit-transform":andrea.string.substitute("scale({0}, {0})",this._scale)});this._viewContainer=new a($("<div/>").appendTo(this._dom$));appRuntime.popup.create=$.proxy(this.createPopup,this),appRuntime.popup.remove=$.proxy(this.removePopup,this);appRuntime.popup.dock=$.proxy(this.dockPopup,this);this._popups=[]};andrea.oo.extend(e,c);e.prototype.createPopup=function(h,i){var g=new h($("<div/>").addClass("qsPopup").appendTo(this._dom$));this._popups.push(g);if(i){var j=$("html");var f=function(){j.off(appRuntime.events.click);appRuntime.popup.remove(g)};_.defer(function(){j.on(appRuntime.events.click,f)});g.dom$().on(appRuntime.events.click,function(k){k.stopPropagation()})}new PageTransitions(null,g.dom$()).nextPage(PageTransitions.animations.createPopup);return g};e.prototype.removePopup=function(f,g){this._popups.splice(this._popups.indexOf(f),1);new PageTransitions(f.dom$(),null).nextPage(PageTransitions.animations.removePopup,function(){f.destroy();if(g){g()}})};e.prototype.dockPopup=function(f,i,j,m,l){var h=b.parseDOM(this._dom$);var n=b.parseDOM(i);var g=Math.round((n.left()-h.left())/this._scale);var k=Math.round((n.top()-h.top())/this._scale);d.dock(f,new b(g,k,n.width(),n.height()),j,m,l)};return e});define("app",["app/Root"],function(g){var f=$(document.body).children()[0],e=$(f);var d=$(window).width(),h=$(window).height();var c=d<h?d/h:640/960;var a=Math.max(0,h),b=c*a;e.css({width:b+"px",height:a+"px"});new g($("<div/>").appendTo(e),b,a)});define("app/components/ItemMain",["ui/UIComponent","app/managers/TemplateManager","app/services/DataService"],function(c,b,a){var d=function(e){d.superclass.constructor.apply(this,arguments);async.parallel([function(f){b.load("item.html",true,function(g,h){this._dom$.append(h);f(null)}.bind(this))}.bind(this),function(f){b.load("item-main.html",true,function(g,h){f(null,h)}.bind(this))}.bind(this),function(f){a.request("/item",null,f)}.bind(this)],function(h,f){var g=f[1];g.appendTo($(".qsItemMain",this._dom$));this._render(f[2])}.bind(this))};andrea.oo.extend(d,c);d.prototype._render=function(e){videojs($(".qsItemVideo",this._dom$).get(0))};return d});define("app/views/Item",["ui/scroll/IScrollContainer","app/views/ViewBase","app/components/Header","app/components/ItemMain","app/components/ItemGallery"],function(a,c,f,d,e){var b=function(j){b.superclass.constructor.apply(this,arguments);var k=new f($("<div/>").appendTo(this._dom$),"商品 xxx");var h=new a($("<div/>").css({width:"100%",height:this._dom$.height()-k.getPreferredSize().height}).appendTo(this._dom$));var g=new d($("<div/>"));var i=new e($("<div/>"));h.append(g);h.append(i)};andrea.oo.extend(b,c);return b});define("app/views/People",["ui/scroll/IScrollContainer","app/views/ViewBase","app/components/Header","app/components/ItemGallery"],function(a,b,e,d){var c=function(h){c.superclass.constructor.apply(this,arguments);var i=new e($("<div/>").appendTo(this._dom$),"网红 xxx");var f=new a($("<div/>").css({width:"100%",height:this._dom$.height()-i.getPreferredSize().height}).appendTo(this._dom$));var g=new d($("<div/>"));f.append(g)};andrea.oo.extend(c,b);return c});(function(a){var b=[];var c=a.jQuery;if(c){if(jQuery.holdReady){jQuery.holdReady(true)}else{jQuery.readyWait+=1}}require(b,function(){var d=arguments;b.forEach(function(g,f){var e=g.split("/");e.reduce(function(i,j,h){if(!i[j]){if(h<e.length-1){i[j]={}}else{i[j]=d[f]}}return i[j]},a)});if(c){if(jQuery.holdReady){jQuery.holdReady(false)}else{jQuery.ready(true)}}})})(this);if(window.__andrea_internal_requirejs_nextTick__!==undefined){if(requirejs&&requirejs.s&&requirejs.s.contexts&&requirejs.s.contexts._){requirejs.s.contexts._.nextTick=window.__andrea_internal_requirejs_nextTick__}window.__andrea_internal_requirejs_nextTick__=undefined};
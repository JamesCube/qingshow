define("qs/services/httpService",[],function(){var e={},t=null,n=null;return e.config=function(e){t=e.root,n=e.version},e.request=function(e,r,i,s){arguments.length===2&&arguments[1]instanceof Function&&(s=i,i=null),i=i||{};if(r==="get")for(var o in i)i[o]instanceof Array&&(i[o]=i[o].join(","));var u={url:t+e+"?version="+n,type:r,data:i,dataType:"json",cache:!1,xhrFields:{withCredentials:!0}};$.ajax(u).done(function(t){console.log("api done: "+e,i,t),s&&s(null,t.metadata,t.data)}).fail(function(t,n,r){console.log("api fail: "+e,n,r),s&&s(r||"API fail.")}).always(function(){})},e}),define("qs/services/navigationService",[],function(){var e={},t=null,n=null,r=[],i=null;e.config=function(e){t=e.root,n=$(t)},e.push=function(e,t){violet.ui.factory.createViewAsync(e,t,n,function(e,t){s(t)}.bind(this))},e.pop=function(){i.destroy(),r.pop(),i=r[r.length-1],i.show()},e.popAll=function(){while(r.length>1){var e=r[r.length-1];e.destroy(),r.pop()}i=r[0],i.show()};var s=function(e){i&&i.hide(),i=e,r.push(e)};return e}),define("qs/services/downloadService",[],function(){var e={};return e.download=function(){__services.httpService.request("/spread/download","get",{entry:violet.url.search.entity||"",initiatorRef:violet.url.search.initiatorRef||"",targetRef:violet.url.search.targetRef||""},function(e,t,n){}),window.WeixinJSBridge||navigator.userAgent.indexOf("Android")!==-1?window.open("http://a.app.qq.com/o/simple.jsp?pkgname=com.focosee.qingshow"):window.open("https://itunes.apple.com/us/app/qing-xiu/id946116105?ls=1&mt=8")},e}),define("qs/core/model",[],function(){var e=function(){this._trigger$=$({})};return e.prototype.on=function(){this._trigger$.on.apply(this._trigger$,arguments)},e.prototype.one=function(){this._trigger$.one.apply(this._trigger$,arguments)},e.prototype.off=function(){this._trigger$.off.apply(this._trigger$,arguments)},e.prototype.trigger=function(){this._trigger$.trigger.apply(this._trigger$,arguments)},new e}),define("qs/core/bootstrap",["qs/services/httpService","qs/services/navigationService","qs/services/downloadService","qs/core/model","require"],function(e,t,n,r){window.__runtime={model:r},e.config({root:"http://121.41.161.239/services",version:"2.1.0"}),t.config({root:$("#root").get(0)}),window.__services={httpService:e,navigationService:t,downloadService:n};var i=violet.url.search;i.entry==="shareShow"?t.push("qs/views/P02ShareShow",{_id:i._id}):i.entry==="shareTrade"?t.push("qs/views/P03ShareTrade",{_id:i._id}):t.push("qs/views/P01NotFound")}),function(){requirejs.config({baseUrl:"",paths:{qs:"./js"}}),violet.ui.factory.config({moduleToControllerClass:function(e){return e},moduleToTemplatePath:function(e){return e.replace("qs/","./js/")+".html"}}),$(function(){require(["qs/core/bootstrap"])})}(),define("js/app",function(){}),define("qs/views/P01NotFound",[],function(){var e=function(t,n){e.superclass.constructor.apply(this,arguments),this._dom$.text("404: "+window.location.href)};return violet.oo.extend(e,violet.ui.ViewBase),e}),define("qs/views/P02ShareShow",[],function(){var e=function(t,n){e.superclass.constructor.apply(this,arguments),__services.httpService.request("/spread/open","get",{entry:violet.url.search.entity||"",initiatorRef:violet.url.search.initiatorRef||"",targetRef:violet.url.search.targetRef||""},function(e,t,n){});var r=[];for(var i=1;i<5;i++)r.push(violet.string.substitute("./assets/slicing/p02/share_show_{0}.png",i));var s=$(".p02-image-slider-block-image",this._dom);for(var o=1;o<s.size();o++){var t=s[o];$(t).css("background-image",violet.string.substitute("url({0})",r[o]))}$(window).resize(function(){this.handleResize()}.bind(this)),__services.httpService.request("/show/query","get",{_ids:[n._id]},function(e,t,n){if(n){var r=n.shows[0],i=$($(".p02-image-slider-block-image",this._dom)[0]);i.css("background-image",violet.string.substitute("url({0})",r.cover)),i.attr("src",r.coverForeground),$(".p02-image-slider",this._dom).slick()}}.bind(this)),$(".p02-download",this._dom).on("click",__services.downloadService.download),$(window).trigger("resize")};return violet.oo.extend(e,violet.ui.ViewBase),e.prototype.handleResize=function(){var e=document.documentElement.clientHeight,t=document.documentElement.clientWidth,n=t,r=e*.88,i=30,s=30,o=r-2*i-s,u=o*420/760,a=(n-u)/2;$(".p02-image-slider-block-content",this._dom).css({width:n,height:r}),$(".p02-image-slider-block-image-container",this._dom).css({width:u,height:o,"margin-left":a,"margin-right":a,"margin-top":i,"margin-bottom":i}),$(".p02-image-slider-block-image",this._dom).css({width:u,height:o})},e}),define("qs/views/P03ShareTrade",[],function(){var e=function(t,n){e.superclass.constructor.apply(this,arguments),__services.httpService.request("/spread/open","get",{entry:violet.url.search.entity||"",initiatorRef:violet.url.search.initiatorRef||"",targetRef:violet.url.search.targetRef||""},function(e,t,n){}),__services.httpService.request("/trade/query","get",{_ids:[n._id]},function(e,t,n){if(n){var r=n.trades[0],i=r.itemSnapshot;$(".p03-trade-item-cover",this._dom).css("background-image",violet.string.substitute("url({0})",i.thumbnail)),$(".p03-trade-item-title",this._dom)[0].innerText=i.name,$(".p03-trade-item-price-number",this._dom)[0].innerText="￥"+parseFloat(i.price).toFixed(2),$(".p03-trade-item-tmall-price-number",this._dom)[0].innerText="￥"+parseFloat(i.promoPrice).toFixed(2);if(r.actualPrice){var s=parseFloat(i.promoPrice||i.price),o=parseFloat(r.actualPrice),u=o*100/s;$(".p03-trade-item-qingshow-discount-number",this._dom)[0].innerText=u.toFixed(2)+"%",$(".p03-trade-item-qingshow-price-number",this._dom)[0].innerText="￥"+o.toFixed(2)}}}.bind(this)),$(".p03-download",this._dom).on("click",__services.downloadService.download),$(".p03-success",this._dom).on("click",__services.downloadService.download)};return violet.oo.extend(e,violet.ui.ViewBase),e});